<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Introducción a NestJS - Guía práctica</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        html, body {height:100%; margin:0;}
        body {display:flex; flex-direction:column;}
        main {flex:1 0 auto;}
        footer {flex-shrink:0;}
        .codecard {position:relative;}
        /* Se elimina el estilo activo para evitar resaltados en la TOC */
        .editor-bg {background:#0b1220;}
        .editor-code {font-family: 'Fira Mono', 'Consolas', monospace; font-size:1rem; line-height:1.6; color:#e6eef8}
        .kw {color:#7dd3fc;}
        .fn {color:#f472b6;}
        .str {color:#facc15;}
        .var {color:#a3e635;}
        .com {color:#94a3b8;}
        .attr {color:#fbbf24;}

        /* Header shared styles (copied from index.html) */
        header { overflow: visible; padding-top: env(safe-area-inset-top); }
        :root { --header-offset: 9.5rem; }
        .logo-wrap { display:flex; align-items:center; gap:0.75rem; }
        .logo-circle { border-radius:9999px; background:rgba(255,255,255,0.08); display:flex; align-items:center; justify-content:center; }
        .logo-circle { padding:0.5rem; width:64px; height:64px; }
        .brand-title { font-size:1.375rem; }
        .brand-sub { font-size:0.875rem; }
        @media(min-width:640px){ .logo-circle { padding:0.75rem; width:80px; height:80px; } .brand-title { font-size:1.75rem; } .brand-sub { font-size:0.95rem; } }
        @media(min-width:1024px){ .logo-circle { padding:1rem; width:96px; height:96px; } .brand-title { font-size:2.25rem; } .brand-sub { font-size:1rem; } }
    </style>
</head>
<body class="bg-gray-100 font-sans text-gray-800">
<!-- Unified header (same as index) -->
<header class="bg-gradient-to-r from-blue-700 via-cyan-600 to-indigo-700 text-white py-8 sm:py-12 md:py-16 lg:py-20 sticky top-0 z-50 shadow-lg">
    <div class="container mx-auto px-4">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="logo-wrap animate-fade-in-down">
                <div class="logo-circle">
                    <i class="fab fa-react text-cyan-200" style="font-size:2rem"></i>
                </div>
                <div>
                    <h1 class="brand-title font-extrabold leading-tight">Curso de Frontend - Desarrollo de software</h1>
                    <p class="brand-sub mt-1 text-cyan-100/90">Guía práctica — Arle Morales Ortiz</p>
                </div>
            </div>

            <div class="text-right">
                <h1 class="text-2xl md:text-4xl font-extrabold">11. Introducción a NestJS</h1>
                <!-- Botón eliminado por preferencia: no resaltar temas -->
            </div>
         </div>
     </div>
 </header>

<section class="bg-gradient-to-r from-indigo-50 to-indigo-100 border-b border-indigo-200">
    <div class="container mx-auto px-4 py-6 md:py-8">
        <div class="flex flex-col md:flex-row items-center gap-6">
            <div class="flex-1">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-900 mb-2">
                    <i class="fa-solid fa-link mr-2"></i>Resumen rápido
                </h2>
                <p class="text-gray-700">NestJS es un framework progresivo para Node.js que aprovecha TypeScript y sigue principios de arquitectura modular y patrones inspirados en Angular. Ideal para construir APIs escalables y mantenibles.</p>
            </div>
            <!-- botón "Comenzar" eliminado por preferencia de no resaltar -->
        </div>
    </div>
</section>

<main class="container mx-auto px-4 py-8 section-offset">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <aside class="lg:col-span-3">
            <div class="bg-white rounded-2xl shadow p-4 sticky top-6 toc">
                <h3 class="font-semibold text-indigo-800 mb-3 flex items-center gap-2">
                    <i class="fa-solid fa-list"></i> Contenido
                </h3>
                <nav class="flex flex-col gap-2 text-sm">
                    <a class="px-3 py-2 rounded-lg hover:bg-indigo-50" href="#instalacion">Instalación y Setup</a>
                    <a class="px-3 py-2 rounded-lg hover:bg-indigo-50" href="#primer-proyecto">Primer Proyecto</a>
                    <a class="px-3 py-2 rounded-lg hover:bg-indigo-50" href="#fundamentos">Fundamentos</a>
                    <a class="px-3 py-2 rounded-lg hover:bg-indigo-50" href="#rutas">Rutas y Controladores</a>
                    <a class="px-3 py-2 rounded-lg hover:bg-indigo-50" href="#servicios">Servicios e Inyección de Dependencias</a>
                    <a class="px-3 py-2 rounded-lg hover:bg-indigo-50" href="#middleware">Middleware (ejemplos)</a>
                    <a class="px-3 py-2 rounded-lg hover:bg-indigo-50" href="#ejemplos">Ejemplos prácticos</a>
                </nav>
            </div>
        </aside>

        <section class="lg:col-span-9 space-y-8">

            <article id="instalacion" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-800 mb-4 flex items-center gap-3"><i class="fa-solid fa-download"></i> 1. Instalación y Setup</h2>

                <h3 class="text-lg font-semibold text-indigo-700 mt-2">A. Requisitos previos</h3>
                <p class="text-gray-700">Antes de comenzar asegúrate de tener instalados: Node.js (>=14), npm o pnpm/yarn y conocimientos básicos de TypeScript.</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-4">B. Instalar Nest CLI y crear un proyecto</h3>
                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// Instalar Nest CLI globalmente</span><br>
                        <span class="kw">npm</span> <span class="fn">i</span> <span class="str">-g @nestjs/cli</span><br><br>
                        <span class="com">// Crear un nuevo proyecto</span><br>
                        <span class="fn">nest</span> <span class="kw">new</span> <span class="str">my-first-nest-app</span>
                    </div>
                </div>

                <p class="text-gray-700">El CLI generará una estructura inicial y te preguntará por el gestor de paquetes. Usa TypeScript por defecto (es la opción recomendada).</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-4">C. Estructura básica del proyecto</h3>
                <p class="text-gray-700 mb-2">Un proyecto Nest típico contiene:</p>
                <ul class="list-disc pl-6 text-gray-700">
                    <li><b>src/app.module.ts</b> — módulo raíz que importa otros módulos.</li>
                    <li><b>src/main.ts</b> — punto de entrada donde se crea la aplicación Nest.</li>
                    <li><b>src/app.controller.ts</b> — controlador de ejemplo.</li>
                    <li><b>src/app.service.ts</b> — servicio de ejemplo inyectable.</li>
                </ul>

                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/main.ts</span><br>
                        <span class="kw">import</span> { <span class="var">NestFactory</span> } <span class="kw">from</span> <span class="str">'@nestjs/core'</span>;<br>
                        <span class="kw">import</span> { <span class="var">AppModule</span> } <span class="kw">from</span> <span class="str">'./app.module'</span>;<br><br>
                        <span class="kw">async function</span> <span class="fn">bootstrap</span>() {<br>
                        &nbsp;&nbsp;<span class="kw">const</span> app = <span class="kw">await</span> <span class="var">NestFactory</span>.<span class="fn">create</span>(<span class="var">AppModule</span>);<br>
                        &nbsp;&nbsp;await app.<span class="fn">listen</span>(3000);<br>
                        }<br>
                        <span class="fn">bootstrap</span>();
                    </div>
                </div>

                <p class="text-gray-700">Con esto tienes la app corriendo en http://localhost:3000. A partir de aquí crearás controladores, servicios y módulos.</p>
            </article>

            <article id="primer-proyecto" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-800 mb-4 flex items-center gap-3"><i class="fa-solid fa-cubes-stacked"></i> 2. Primer Proyecto en NestJS</h2>
                <p class="text-gray-700">Vamos a crear un proyecto mínimo que exponga una ruta raíz y devuelva un mensaje. Incluye AppModule, AppController y AppService.</p>

                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/app.module.ts</span><br>
                        <span class="kw">import</span> { <span class="var">Module</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>
                        <span class="kw">import</span> { <span class="var">AppController</span> } <span class="kw">from</span> <span class="str">'./app.controller'</span>;<br>
                        <span class="kw">import</span> { <span class="var">AppService</span> } <span class="kw">from</span> <span class="str">'./app.service'</span>;<br><br>
                        <span class="kw">@Module</span>({<br>
                        &nbsp;&nbsp;<span class="attr">imports</span>: [],<br>
                        &nbsp;&nbsp;<span class="attr">controllers</span>: [<span class="var">AppController</span>],<br>
                        &nbsp;&nbsp;<span class="attr">providers</span>: [<span class="var">AppService</span>],<br>
                        })<br>
                        <span class="kw">export class</span> <span class="var">AppModule</span> {}
                    </div>
                </div>

                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/app.controller.ts</span><br>
                        <span class="kw">import</span> { <span class="var">Controller</span>, <span class="var">Get</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>
                        <span class="kw">import</span> { <span class="var">AppService</span> } <span class="kw">from</span> <span class="str">'./app.service'</span>;<br><br>
                        <span class="kw">@Controller</span>()<br>
                        <span class="kw">export class</span> <span class="var">AppController</span> {<br>
                        &nbsp;&nbsp;<span class="kw">constructor</span>(<span class="kw">private readonly</span> <span class="var">appService</span>: <span class="var">AppService</span>) {}<br>

                        &nbsp;&nbsp;<span class="kw">@Get</span>()<br>
                        &nbsp;&nbsp;<span class="kw">getRoot</span>() {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="kw">return</span> this.<span class="var">appService</span>.<span class="fn">getHello</span>();<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/app.service.ts</span><br>
                        <span class="kw">import</span> { <span class="var">Injectable</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>

                        <span class="kw">@Injectable</span>()<br>
                        <span class="kw">export class</span> <span class="var">AppService</span> {<br>
                        &nbsp;&nbsp;<span class="kw">getHello</span>() {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="kw">return</span> <span class="str">'¡Hola desde NestJS!'</span>;<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <p class="text-gray-700">Con esto, al iniciar la app y visitar GET / verás el texto '¡Hola desde NestJS!'.</p>
            </article>

            <article id="fundamentos" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-800 mb-4 flex items-center gap-3"><i class="fa-solid fa-book"></i> 3. Fundamentos de NestJS</h2>
                <p class="text-gray-700">A continuación profundizamos en los conceptos básicos que deberías dominar.</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-4">A. Módulos</h3>
                <p class="text-gray-700">Los <b>módulos</b> son la forma de organizar funcionalidades en Nest. Cada módulo declara sus controladores y proveedores (servicios). Un proyecto grande tendrá múltiples módulos por dominio (users, auth, products, etc.).</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-4">B. Controladores</h3>
                <p class="text-gray-700">Los <b>controladores</b> manejan las rutas HTTP y delegan la lógica a los servicios. Se usan decoradores como <code>@Controller()</code>, <code>@Get()</code>, <code>@Post()</code>, etc.</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-4">C. Servicios</h3>
                <p class="text-gray-700">Los <b>servicios</b> contienen la lógica de negocio y se definen con <code>@Injectable()</code>. Nest se encarga de resolver dependencias e instanciarlos cuando son requeridos.</p>
            </article>

            <article id="rutas" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-800 mb-4 flex items-center gap-3"><i class="fa-solid fa-route"></i> 4. Rutas y Controladores</h2>
                <p class="text-gray-700">Aquí vemos cómo definir rutas, recibir parámetros y responder desde controladores.</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-3">Decoradores HTTP</h3>
                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// Ejemplo: users.controller.ts</span><br>
                        <span class="kw">import</span> { <span class="var">Controller</span>, <span class="var">Get</span>, <span class="var">Post</span>, <span class="var">Param</span>, <span class="var">Body</span>, <span class="var">Query</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>
                        <span class="kw">@Controller</span>(<span class="str">'users'</span>)<br>
                        <span class="kw">export class</span> <span class="var">UsersController</span> {<br>
                        &nbsp;&nbsp;<span class="kw">@Get</span>()<br>
                        &nbsp;&nbsp;<span class="kw">findAll</span>(<span class="var">@Query</span>() query) { return { query } }<br>

                        &nbsp;&nbsp;<span class="kw">@Get</span>(<span class="str">':id'</span>)<br>
                        &nbsp;&nbsp;<span class="kw">findOne</span>(<span class="var">@Param</span>(<span class="str">'id'</span>) id: string) { return { id } }<br>

                        &nbsp;&nbsp;<span class="kw">@Post</span>()<br>
                        &nbsp;&nbsp;<span class="kw">create</span>(<span class="var">@Body</span>() body) { return { created: body } }<br>
                        }
                    </div>
                </div>

                <p class="text-gray-700">Explicación rápida: <code>@Param</code> extrae parámetros de ruta, <code>@Query</code> obtiene query strings y <code>@Body</code> el cuerpo de la petición (JSON).</p>
            </article>

            <article id="servicios" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-800 mb-4 flex items-center gap-3"><i class="fa-solid fa-gears"></i> 5. Servicios y Dependencias</h2>
                <p class="text-gray-700">La inyección de dependencias es central en Nest. Los servicios se declaran como proveedores y Nest los inyecta automáticamente donde se requieran.</p>

                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/users/users.service.ts</span><br>
                        <span class="kw">import</span> { <span class="var">Injectable</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>
                        <span class="kw">@Injectable</span>()<br>
                        <span class="kw">export class</span> <span class="var">UsersService</span> {<br>
                        &nbsp;&nbsp;private users = [];
<br>
                        &nbsp;&nbsp;<span class="kw">findAll</span>() { return this.users; }<br>
                        &nbsp;&nbsp;<span class="kw">create</span>(user) { this.users.push(user); return user; }<br>
                        }
                    </div>
                </div>

                <p class="text-gray-700">Luego inyectas el servicio en el controlador por constructor: <code>constructor(private readonly usersService: UsersService) { }</code></p>
            </article>

            <article id="middleware" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-800 mb-4 flex items-center gap-3"><i class="fa-solid fa-filter"></i> 6. Middleware</h2>
                <p class="text-gray-700">El middleware en Nest funciona como en Express: recibe la request antes del controlador. Útil para logging, validación, autenticación, etc.</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-3">Ejemplo: Middleware de Logging</h3>
                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/common/middleware/logging.middleware.ts</span><br>
                        <span class="kw">import</span> { <span class="var">Injectable</span>, <span class="var">NestMiddleware</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>
                        <span class="kw">import</span> { <span class="var">Request</span>, <span class="var">Response</span>, <span class="var">NextFunction</span> } <span class="kw">from</span> <span class="str">'express'</span>;<br>

                        <span class="kw">@Injectable</span>()<br>
                        <span class="kw">export class</span> <span class="var">LoggingMiddleware</span> <span class="kw">implements</span> <span class="var">NestMiddleware</span> {<br>
                        &nbsp;&nbsp;<span class="kw">use</span>(req: <span class="var">Request</span>, res: <span class="var">Response</span>, next: <span class="var">NextFunction</span>) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;console.log(`[${new Date().toISOString()}] ${req.method} ${req.originalUrl}`);<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;next();<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <p class="text-gray-700">Registrar el middleware en <code>app.module.ts</code> o en un módulo específico mediante el método <code>configure()</code> del módulo.</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-3">Ejemplo: Middleware de Validación simple</h3>
                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/common/middleware/validate.middleware.ts</span><br>
                        <span class="kw">import</span> { <span class="var">NestMiddleware</span>, <span class="var">Injectable</span>, <span class="var">BadRequestException</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>
                        <span class="kw">import</span> { <span class="var">Request</span>, <span class="var">Response</span>, <span class="var">NextFunction</span> } <span class="kw">from</span> <span class="str">'express'</span>;<br>

                        <span class="kw">@Injectable</span>()<br>
                        <span class="kw">export class</span> <span class="var">ValidateMiddleware</span> <span class="kw">implements</span> <span class="var">NestMiddleware</span> {<br>
                        &nbsp;&nbsp;<span class="kw">use</span>(req: <span class="var">Request</span>, res: <span class="var">Response</span>, next: <span class="var">NextFunction</span>) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;const { name, email } = req.body || {};<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;if(!name || !email) throw <span class="kw">new</span> <span class="var">BadRequestException</span>(<span class="str">'name and email required'</span>);<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;next();<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <p class="text-gray-700">Puedes usar también Pipes y DTOs (class-validator) para validaciones más robustas. Aquí mostramos middlewares simples por claridad.</p>
            </article>

            <article id="ejemplos" class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl md:text-3xl font-semibold text-indigo-800 mb-4 flex items-center gap-3"><i class="fa-solid fa-code"></i> 7. Ejemplos prácticos y buenas prácticas</h2>
                <p class="text-gray-700 mb-4">A continuación varios ejemplos y explicaciones detalladas para consolidar conceptos.</p>

                <h3 class="text-lg font-semibold text-indigo-700 mt-3">A. DTO y Validación con class-validator</h3>
                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/users/dto/create-user.dto.ts</span><br>
                        <span class="kw">import</span> { <span class="var">IsString</span>, <span class="var">IsEmail</span>, <span class="var">Length</span> } <span class="kw">from</span> <span class="str">'class-validator'</span>;<br>
                        <span class="kw">export class</span> <span class="var">CreateUserDto</span> {<br>
                        &nbsp;&nbsp;<span class="kw">@IsString</span>()<br>
                        &nbsp;&nbsp;<span class="attr">name</span>: <span class="var">string</span>;<br>

                        &nbsp;&nbsp;<span class="kw">@IsEmail</span>()<br>
                        &nbsp;&nbsp;<span class="attr">email</span>: <span class="var">string</span>;<br>

                        &nbsp;&nbsp;<span class="kw">@Length</span>(4, 20)<br>
                        &nbsp;&nbsp;<span class="attr">password</span>: <span class="var">string</span>;<br>
                        }
                    </div>
                </div>

                <h3 class="text-lg font-semibold text-indigo-700 mt-3">B. Registrar middleware en un módulo</h3>
                <div class="codecard editor-bg rounded-xl p-4 mb-4">
                    <div class="editor-code">
                        <span class="com">// src/app.module.ts (fragmento)</span><br>
                        <span class="kw">import</span> { <span class="var">MiddlewareConsumer</span>, <span class="var">Module</span>, <span class="var">NestModule</span> } <span class="kw">from</span> <span class="str">'@nestjs/common'</span>;<br>
                        <span class="kw">import</span> { <span class="var">LoggingMiddleware</span> } <span class="kw">from</span> <span class="str">'./common/middleware/logging.middleware'</span>;<br>

                        <span class="kw">@Module</span>({ /* ... */ })<br>
                        <span class="kw">export class</span> <span class="var">AppModule</span> <span class="kw">implements</span> <span class="var">NestModule</span> {<br>
                        &nbsp;&nbsp;<span class="kw">configure</span>(consumer: <span class="var">MiddlewareConsumer</span>) {<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;consumer.apply(<span class="var">LoggingMiddleware</span>).forRoutes('*');<br>
                        &nbsp;&nbsp;}<br>
                        }
                    </div>
                </div>

                <h3 class="text-lg font-semibold text-indigo-700 mt-3">C. Buenas prácticas</h3>
                <ul class="list-disc pl-6 text-gray-700">
                    <li>Organiza código por dominios (feature modules).</li>
                    <li>Usa DTOs y class-validator para validación clara y reutilizable.</li>
                    <li>Prefiere interfaces y contratos en TypeScript para tipos de datos.</li>
                    <li>Escribe tests unitarios para servicios y e2e para rutas.</li>
                </ul>
            </article>

        </section>
    </div>
</main>

<!-- Unified footer (same as index) -->
<footer class="bg-slate-900 text-white py-6">
    <div class="container mx-auto px-4 text-center">
        <p class="text-sm">&copy; 2025  Armenia, Quindío - Arle Morales Ortiz.</p>
        <p class="text-xs text-slate-400 mt-1">Hecho con ❤️ — Mejoras de accesibilidad, animaciones y usabilidad.</p>
    </div>
</footer>

<script>
    // Desplazamiento suave & resaltar enlace activo
    const links = document.querySelectorAll('.toc a');
    const sections = [...links].map(a => document.querySelector(a.getAttribute('href')));
    links.forEach(a=>{
        a.addEventListener('click', e=>{
            e.preventDefault();
            document.querySelector(a.getAttribute('href')).scrollIntoView({behavior:'smooth', block:'start'});
            history.replaceState(null, '', a.getAttribute('href'));
        });
    });
    // Observer conservado pero sin aplicar clases 'active' (sin resaltados)
    const observer = new IntersectionObserver((entries)=>{
        entries.forEach(()=>{
            // No se aplican clases visuales a la TOC para evitar resaltados
            // Se mantiene el observer por si se desea extender comportamiento sin estilo
        });
    }, {rootMargin:"-40% 0px -55% 0px", threshold:0});
    sections.forEach(s=>observer.observe(s));
</script>
<script src="./vendor/header-offset.js"></script>
</body>
</html>
